![yamdb](https://github.com/vamotest/yamdb_final/workflows/yamdb_final%20workflow/badge.svg?branch=master)

<div align="center">
  <img width=200" height="67" src="https://i.ibb.co/Gp361Rp/YAMDB.jpg">
</div>

**REST API для сервиса YaMDb** — базы отзывов о фильмах, книгах и музыке. 

## Index
1. [Описание](#описание)
2. [Документация](#документация)
3. [Алгоритм регистрации пользователей](#алгоритм-регистрации-пользователей)
4. [Пользовательские роли](#пользовательские-роли)
5. [Доступные методы](#доступные-методы)
6. [Использование](использование)
7. [Технологии](#технологии)
8. [Участники](#участники)

## Описание

**API для сервиса YaMDb. Позволяет работать со следующими сущностями:**
 - **Отзывы**:
   - получить список всех отзывов;
   - создать новый отзыв; 
   - получить отзыв по id;
   - частично обновить отзыв по id;
   - удалить отзыв по id.
     
 - **Комментарии к отзывам**:
   - Получить список всех комментариев к отзыву по `id`;
   - создать новый комментарий для отзыва, получить комментарий для отзыва по `id`;
   - частично обновить комментарий к отзыву по `id`;
   - удалить комментарий к отзыву по `id`.
    
 - **JWT-токен**:
   - Отправление confirmation_code на переданный `email`;
   - получение JWT-токена в обмен на `email` и `confirmation_code`.
    
 - **Пользователи**:
   - получить список всех пользователей; 
   - создание пользователя получить пользователя по `username`;
   - изменить данные пользователя по `username`;
   - удалить пользователя по `username`;
   - получить данные своей учетной записи;
   - изменить данные своей учетной записи.
 
- **Категории (типы) произведений**:
   - получить список всех категорий;
   - создать категорию;
   - удалить категорию.
  
- **Категории жанров**:
   - получить список всех жанров
   - создать жанр;
   - удалить жанр.
  
- **Произведения, к которым пишут отзывы**: 
    - получить список всех объектов;
    - создать произведение для отзывов;
    - информация об объекте;
    - обновить информацию об объекте;
    - удалить произведение. 
    
## Документация
[Полная документация API](https://github.com/yandex-praktikum/api_yamdb/blob/master/static/redoc.yaml)


### Алгоритм регистрации пользователей

1. Пользователь отправляет запрос с параметром email на `/auth/email/`.
2. YaMDB отправляет письмо с кодом подтверждения `(confirmation_code)` на адрес `email`.
3. Пользователь отправляет запрос с параметрами `email` и `confirmation_code` на `/auth/token/`, 
в ответе на запрос ему приходит `token` (JWT-токен).
4. При желании пользователь отправляет PATCH-запрос на `/users/me/` и заполняет поля 
в своём профайле (описание полей — в документации).
   
### Пользовательские роли

- **Аноним** — может просматривать описания произведений, читать отзывы и комментарии.
- **Аутентифицированный пользователь** — может, как и Аноним, читать всё, дополнительно он может 
публиковать отзывы и ставить рейтинг произведениям (фильмам/книгам/песням), может комментировать 
чужие отзывы и ставить им оценки; может редактировать и удалять свои отзывы и комментарии.
- **Модератор** — те же права, что и у Аутентифицированного пользователя плюс право удалять любые отзывы и комментарии.
- **Администратор** — полные права на управление проектом и всем его содержимым. 
Может создавать и удалять категории и произведения. Может назначать роли пользователям.
- **Администратор Django** — те же права, что и у роли Администратор.

### Доступные методы:

```
/api/v1/posts (GET, POST, PUT, PATCH, DELETE)
```
```
/api/v1/posts/<id> (GET, POST, PUT, PATCH, DELETE)
```
```
/api/v1/posts/<id>/comments (GET, POST, PUT, PATCH, DELETE)
```
```
/api/v1/posts/<id>/comments/<id> (GET, POST, PUT, PATCH, DELETE)
```
```
/api/v1/group/ (GET, POST)
```
```
/api/v1/follow/ (GET, POST)
```

## Использование

1) `.env.template`

```shell
cat .env.template
```
```text
SECRET_KEY
DEBUG
DJANGO_ALLOWED_HOSTS
DEFAULT_FROM_EMAIL
DB_ENGINE
DB_NAME
POSTGRES_USER
POSTGRES_PASSWORD
DB_HOST
DB_PORT
```
2) При каждом push в ветку `master` разворачивается и деплоится новая версия приложения:
```yaml
on:
  push:
    branches:
      - master
```

## Технологии
- [Python](https://www.python.org/)
- [Django](https://www.djangoproject.com/)
- [Django REST framework](https://www.django-rest-framework.org/)
- [DRF Simple JWT](https://django-rest-framework-simplejwt.readthedocs.io/en/latest/)

## Участники 
 - [vamotest](https://github.com/vamotest) - управление пользователями (Auth и Users): 
   - система регистрации и аутентификации;
   - права доступа, работа с токеном;
   - система подтверждения e-mail, поля.
 - [kleine-alberta](https://github.com/kleine-alberta) - категории (Categories), жанры (Genres) и произведения (Titles): 
   - модели и view; 
   - эндпойнты.
 - [MrGrumpy87](https://github.com/MrGrumpy87) - отзывы (Review) и комментарии (Comments): 
   - модели и view;
   - эндпойнты;
   - права доступа для запросов;
   - рейтинги произведений.